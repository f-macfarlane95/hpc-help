<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Bioconda &mdash; Crop Diversity HPC Help  documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/theme_overrides.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Compiling Software" href="compiling.html" />
    <link rel="prev" title="Slurm - Shortcuts and Aliases" href="slurm-shortcuts.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> Crop Diversity HPC Help
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Introduction</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="faq.html">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="system-overview.html">System Overview</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Getting started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="user-accounts.html">Requesting an Account</a></li>
<li class="toctree-l1"><a class="reference internal" href="ssh.html">Getting Connected</a></li>
<li class="toctree-l1"><a class="reference internal" href="guest-accounts.html">Guest Accounts</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">High performance computing</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="slurm-overview.html">Slurm - Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="slurm-policy.html">Slurm - Queue Policies &amp; Advice</a></li>
<li class="toctree-l1"><a class="reference internal" href="slurm-shortcuts.html">Slurm - Shortcuts and Aliases</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Bioconda</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#installing-bioconda">Installing Bioconda</a></li>
<li class="toctree-l2"><a class="reference internal" href="#finding-packages">Finding packages</a></li>
<li class="toctree-l2"><a class="reference internal" href="#installing-packages">Installing packages</a></li>
<li class="toctree-l2"><a class="reference internal" href="#listing-packages">Listing packages</a></li>
<li class="toctree-l2"><a class="reference internal" href="#removing-packages">Removing packages</a></li>
<li class="toctree-l2"><a class="reference internal" href="#environments">Environments</a></li>
<li class="toctree-l2"><a class="reference internal" href="#removing-bioconda">Removing Bioconda</a></li>
<li class="toctree-l2"><a class="reference internal" href="#bioconda-and-slurm">Bioconda and Slurm</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="compiling.html">Compiling Software</a></li>
<li class="toctree-l1"><a class="reference internal" href="file-compression.html">Working with Compressed Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="singularity.html">Apptainer (Singularity)</a></li>
<li class="toctree-l1"><a class="reference internal" href="gpu.html">GPU Processing</a></li>
<li class="toctree-l1"><a class="reference internal" href="machine-learning.html">Machine Learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="apps.html">Tools &amp; Applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="database-mirrors.html">Database Mirrors</a></li>
<li class="toctree-l1"><a class="reference internal" href="openmpi.html">OpenMPI</a></li>
<li class="toctree-l1"><a class="reference internal" href="green-computing.html">Green Computing</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Data storage</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="data-storage.html">Data Storage &amp; Management Policy</a></li>
<li class="toctree-l1"><a class="reference internal" href="backups.html">Backups</a></li>
<li class="toctree-l1"><a class="reference internal" href="file-transfers.html">File Transfers</a></li>
<li class="toctree-l1"><a class="reference internal" href="samba.html">Samba Access</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Miscellaneous</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="contact-us.html">Contact Us</a></li>
<li class="toctree-l1"><a class="reference internal" href="monitoring.html">Monitoring &amp; Tracking</a></li>
<li class="toctree-l1"><a class="reference internal" href="linux-basics.html">Linux Basics</a></li>
<li class="toctree-l1"><a class="reference internal" href="tips.html">Tips &amp; Tricks</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">The legal stuff</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="organizations.html">Supported Organisations</a></li>
<li class="toctree-l1"><a class="reference internal" href="sla.html">Service Level Agreement</a></li>
<li class="toctree-l1"><a class="reference internal" href="acceptable-use.html">Acceptable Use Policy</a></li>
<li class="toctree-l1"><a class="reference internal" href="gdpr.html">GDPR Privacy Notice</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Crop Diversity HPC Help</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Bioconda</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/cropgeeks/hpc-help/blob/master/bioconda.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="bioconda">
<h1>Bioconda<a class="headerlink" href="#bioconda" title="Permalink to this headline"></a></h1>
<p>Bioconda (<a class="reference external" href="https://bioconda.github.io">https://bioconda.github.io</a>) is a community managed set of packages providing bioinformatics software, with a repository of over 8,500 packages (as of August 2021) ready to install. It is part of the conda system which includes standard Linux/Unix tools as well.</p>
<p>Using conda allows you to pick and choose the software (and versions) that you want without any danger of clashing with anyone else’s requirements, and as most packages require nothing more than running <code class="docutils literal notranslate"><span class="pre">conda</span> <span class="pre">install</span> <span class="pre">&lt;packagename&gt;</span></code>, the process is incredibly easy.</p>
<p>Follow the instructions below to get up and running with Bioconda in just a few minutes.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>In order to maintain compatibility with the system’s backup and data policies, you should not attempt to install Bioconda using any other method than the one listed here.</p>
</div>
<section id="installing-bioconda">
<h2>Installing Bioconda<a class="headerlink" href="#installing-bioconda" title="Permalink to this headline"></a></h2>
<p>To install Bioconda, simply run: <code class="docutils literal notranslate"><span class="pre">install-bioconda</span></code> while logged into <code class="docutils literal notranslate"><span class="pre">gruffalo</span></code>. This will automatically download the necessary files for you, install it to an appropriate area, and then setup the correct channels for finding software for you. By default, it’ll install channel information for R, conda-forge,  Bioconda and the underlying Conda system itself.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>You must log out and in again (or open a new shell window) before the changes made by the install script will take effect.</p>
</div>
<p>You should test that installation was successful:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ conda --version
conda 4.10.3
</pre></div>
</div>
</section>
<section id="finding-packages">
<h2>Finding packages<a class="headerlink" href="#finding-packages" title="Permalink to this headline"></a></h2>
<p>There are several options for finding software packages that you can install:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://anaconda.org/bioconda/">browse the package list</a> online to see what’s available</p></li>
<li><p>use <code class="docutils literal notranslate"><span class="pre">conda</span> <span class="pre">search</span> <span class="pre">&lt;packagename&gt;</span></code></p></li>
</ul>
<p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ conda search samtools
Fetching package metadata .................
samtools                     1.3                           0  bioconda
                             1.3                           1  bioconda
                             1.3                           2  bioconda
                             1.3.1                         0  bioconda
                             1.3.1                         1  bioconda
                             1.3.1                         2  bioconda
                             1.3.1                         3  bioconda
                             1.3.1                         4  bioconda
                             1.3.1                         5  bioconda
                             1.4                           0  bioconda
                             1.4.1                         0  bioconda
                             1.5                           0  bioconda
                             1.5                           1  bioconda
                             1.5                           2  bioconda
                             1.6                           0  bioconda
</pre></div>
</div>
<p>Once you know the name of the package (and optionally its version), you can query for more information using <code class="docutils literal notranslate"><span class="pre">conda</span> <span class="pre">search</span> <span class="pre">&lt;packagename&gt;</span> <span class="pre">--info</span></code> or <code class="docutils literal notranslate"><span class="pre">conda</span> <span class="pre">search</span> <span class="pre">&lt;packagename&gt;=&lt;version&gt;</span> <span class="pre">--info</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ conda search samtools=1.4 --info
Fetching package metadata .................

samtools 1.4 0
--------------
file name   : samtools-1.4-0.tar.bz2
name        : samtools
version     : 1.4
build string: 0
build number: 0
channel     : bioconda
size        : 981 KB
arch        : x86_64
has_prefix  : True
license     : MIT
md5         : ba63ece45b20644cbbb753e9ca0394c0
noarch      : None
platform    : linux
requires    : ()
subdir      : linux-64
url         : https://conda.anaconda.org/bioconda/linux-64/samtools-1.4-0.tar.bz2
dependencies:
    curl
    libgcc
    xz
    zlib
</pre></div>
</div>
<p>Importantly, this will tell you what dependencies the package may have, although conda will always resolve these for you automatically.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you don’t specify a version (by using <code class="docutils literal notranslate"><span class="pre">&lt;packagename&gt;=&lt;version&gt;</span></code>) then Bioconda will assume you’re interested in the latest version, which is probably what you want most of the time anyway.</p>
</div>
</section>
<section id="installing-packages">
<h2>Installing packages<a class="headerlink" href="#installing-packages" title="Permalink to this headline"></a></h2>
<p>To install, use <code class="docutils literal notranslate"><span class="pre">conda</span> <span class="pre">install</span> <span class="pre">&lt;packagename&gt;</span></code>. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ conda install samtools
Fetching package metadata .................
Solving package specifications: .

The following NEW packages will be INSTALLED:

    bzip2:     1.0.6-1           conda-forge
    curl:      7.54.1-0          conda-forge
    krb5:      1.14.2-0          conda-forge
    libgcc:    7.2.0-h69d50b8_2
    libssh2:   1.8.0-1           conda-forge
    samtools:  1.6-0             bioconda

Proceed ([y]/n)? y

bzip2-1.0.6-1. 100% |#####################################| Time: 0:00:00 476.24 kB/s
krb5-1.14.2-0. 100% |#####################################| Time: 0:00:01   3.07 MB/s
libssh2-1.8.0- 100% |#####################################| Time: 0:00:00  26.50 MB/s
libgcc-7.2.0-h 100% |#####################################| Time: 0:00:00  19.51 MB/s
curl-7.54.1-0. 100% |#####################################| Time: 0:00:00   3.23 MB/s
samtools-1.6-0 100% |#####################################| Time: 0:00:01 999.31 kB/s
</pre></div>
</div>
<p>To update an existing package at a later date (eg to its newest version), you can use:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ conda update samtools
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>At some point you will run into a conflict and/or find this process gets slower and slower. One recommendation is to use “environments” (see below). Another suggestion is <code class="docutils literal notranslate"><span class="pre">conda</span> <span class="pre">install</span> <span class="pre">mamba</span></code> and then use <code class="docutils literal notranslate"><span class="pre">mamba</span> <span class="pre">install</span> <span class="pre">&lt;packagename&gt;</span></code>. Continuing the snake naming theme, <a class="reference external" href="https://mamba.readthedocs.io/">Mamba</a> is an alternative to the Conda installation tool which uses a different and faster approach to solving the dependency tree - hopefully that technique will be adopted into the standard conda tool at some point.</p>
</div>
</section>
<section id="listing-packages">
<h2>Listing packages<a class="headerlink" href="#listing-packages" title="Permalink to this headline"></a></h2>
<p>To retrieve a list of installed packages, use:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ conda list
libssh2                   1.8.0                         1    conda-forge
readline                  6.2                           2
requests                  2.18.4           py36he2e5f8d_1
samtools                  1.6                           0    bioconda
setuptools                36.5.0           py36he42e2e1_0
</pre></div>
</div>
<p>This returns entries not only for Bioconda, but also for packages from repositories that Bioconda relies upon, such as conda and conda-forge. You can filter the list using:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ conda list | grep bioconda
</pre></div>
</div>
</section>
<section id="removing-packages">
<h2>Removing packages<a class="headerlink" href="#removing-packages" title="Permalink to this headline"></a></h2>
<p>Removing packages is as simple as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ conda remove samtools
Fetching package metadata .................
Solving package specifications: .

The following packages will be REMOVED:

    samtools: 1.6-0 bioconda

Proceed ([y]/n)? y
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Removing a package doesn’t remove its dependencies, so over time you may find your Bioconda install growing quite large, so run <code class="docutils literal notranslate"><span class="pre">conda</span> <span class="pre">clean</span></code> to tidy things up.</p>
</div>
</section>
<section id="environments">
<h2>Environments<a class="headerlink" href="#environments" title="Permalink to this headline"></a></h2>
<p>While conda is good at resolving package dependencies, it’s likely you’ll (eventually) find a package you can’t install because its dependencies clash with those of already-installed package (which often happens when packages rely on one of the major versions of Python (2 or 3)). Another problematic situation arises if you want to have multiple versions of the same package installed.</p>
<p>Both of these issues can be resolved using environments, which are best thought of as a standalone, isolated working copies of conda.</p>
<p>To use a separate environment, you first need to create it:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ conda create -n samtools-old
</pre></div>
</div>
<p>This environment is isolated from your main conda installation, so you need to activate it before use (note how the command prompt changes when this happens):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ conda activate samtools-old
(samtools-old) $
</pre></div>
</div>
<p>You can then proceed to install packages into your new environment:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>(samtools-old) $ conda install samtools=1.4
</pre></div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>You can merge creating a new environment and installing packages into it using just a single command: <code class="docutils literal notranslate"><span class="pre">conda</span> <span class="pre">create</span> <span class="pre">-n</span> <span class="pre">samtools-old</span> <span class="pre">samtools=1.4</span></code>.</p>
</div>
<p>You can continue to install more packages into this environment if need be, and run scripts and analyses as normal. Once finished with an environment, return to a normal prompt (and your default conda environment) using:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>(samtools-old) $ conda deactivate
</pre></div>
</div>
<p>Here’s how to get a list of all available environments:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ conda env list
# conda environments:
#
samtools-old             /$APPS/conda/envs/samtools-old
root                  *  /$APPS/conda
</pre></div>
</div>
<p>Conda refers to your base environment as <code class="docutils literal notranslate"><span class="pre">root</span></code> and marks the active one with a <code class="docutils literal notranslate"><span class="pre">*</span></code>.</p>
<p>If you want to get rid of an environment, make sure it’s not active, then run:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ conda remove --all -n samtools-old
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>One school of thought suggests installing every package into its own unique environment. While this certainly avoids any dependency clash problems, it can make things a little awkward if you have pipelines or scripts relying on multiple packages as you’re then constantly running <code class="docutils literal notranslate"><span class="pre">conda</span> <span class="pre">activate</span></code> and <code class="docutils literal notranslate"><span class="pre">conda</span> <span class="pre">deactivate</span></code>. Some people go further and suggest your base environment should include only the alternative installation tool <code class="docutils literal notranslate"><span class="pre">mamba</span></code>, and everything else should go in environments. Ultimately though, it’s up to you how you set up and manage Bioconda.</p>
</div>
</section>
<section id="removing-bioconda">
<h2>Removing Bioconda<a class="headerlink" href="#removing-bioconda" title="Permalink to this headline"></a></h2>
<p>Conda and Bioconda are installed in <code class="docutils literal notranslate"><span class="pre">$APPS/conda</span></code>. Simply delete this folder to remove Bioconda and any additional packages you’ve installed or environments you’ve created.</p>
</section>
<section id="bioconda-and-slurm">
<h2>Bioconda and Slurm<a class="headerlink" href="#bioconda-and-slurm" title="Permalink to this headline"></a></h2>
<p>When using the <code class="docutils literal notranslate"><span class="pre">conda</span> <span class="pre">activate</span></code> command in an <code class="docutils literal notranslate"><span class="pre">sbatch</span></code> job script you may encounter an error mesage:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CommandNotFoundError</span><span class="p">:</span> <span class="n">Your</span> <span class="n">shell</span> <span class="n">has</span> <span class="ow">not</span> <span class="n">been</span> <span class="n">properly</span> <span class="n">configured</span> <span class="n">to</span> <span class="n">use</span> <span class="s1">&#39;conda activate&#39;</span><span class="o">.</span>
</pre></div>
</div>
<p>And subsequently when trying to use commands from the package you may get a <code class="docutils literal notranslate"><span class="pre">command</span> <span class="pre">not</span> <span class="pre">found</span></code> error.</p>
<p>You can work around this by using <code class="docutils literal notranslate"><span class="pre">source</span> <span class="pre">activate</span> <span class="pre">&lt;environment&gt;</span></code> instead.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If conda cannot be found on your <code class="docutils literal notranslate"><span class="pre">$PATH</span></code> then you’ll need to provide its full path with the command, for example: <code class="docutils literal notranslate"><span class="pre">source</span> <span class="pre">/full/path/to/conda/bin/activate</span> <span class="pre">&lt;environment&gt;</span></code>.</p>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="slurm-shortcuts.html" class="btn btn-neutral float-left" title="Slurm - Shortcuts and Aliases" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="compiling.html" class="btn btn-neutral float-right" title="Compiling Software" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022 Information &amp; Computational Sciences, The James Hutton Institute.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>